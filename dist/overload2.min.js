var MODULE_REQUIRE,declareException=function declareException(name,parent,constructorFunction){if(!parent)parent=Error;var Ex=function(message){this.name="OVERLOAD2."+name;if(constructorFunction){constructorFunction.apply(this,arguments)}else{this.message=message}var err=new parent;this.stack=[this.name+": "+this.message].concat(err.stack.split("\n").slice(2)).join("\n")};Ex.prototype=Object.create(parent.prototype);Ex.prototype.consturctor=Ex;Ex.prototype.toString=Ex.prototype.valueOf=function(){return"["+this.name+": "+this.message+"]"};Object.defineProperty(Ex,"name",{value:name});return Ex},ERR={Generic:declareException("Error"),Arguments:declareException("ArgumentsError",TypeError,function(expected,actual){this.message=expected+" argument(s) expected but actual "+actual}),Type:declareException("TypeError",TypeError,function(desc,types,actual){this.message=desc+" must be "+(typeof types=="string"?types:types.join(" | "))+": "+actual}),Range:declareException("RangeError",RangeError,function(desc,info,actual){if(info instanceof Array){info=info.join(" | ")}this.message=desc+" must be "+info+": "+actual}),NotImplemented:declareException("EmptyException"),Unmatching:declareException("UnmatchingException",TypeError)},generateCreator=function(C){function F(args){return C.apply(this,args)}F.prototype=C.prototype;return function(){return new F(arguments)}},has=function(arr,item){return arr.indexOf(item)>=0};function Type(matcher){if(arguments.length!=1){throw new ERR.Arguments(1,arguments.length)}if(!(typeof matcher=="function"||matcher instanceof RegExp)){throw new ERR.Type("Type matcher",["Function","RegExp"],matcher)}if(!(this instanceof Type))return new Type(matcher);if(matcher instanceof RegExp)this.match=function(value){return matcher.test(value)};else this.match=matcher}function Param(){if(arguments.length==0){throw new ERR.Arguments("1+",0)}if(arguments.length==1&&arguments[0]instanceof Param){return arguments[0]}var type=arguments[0],decos=[];if(typeof type=="string"){decos=type.trim().split(/\s+/);type=decos.shift();var formalType=TYPE_ALIAS[type];if(!formalType){throw new ERR.Range("type alias",Object.keys(TYPE_ALIAS),type)}type=formalType}else if(type instanceof Type){}else if(typeof type=="function"){type=function(type){return new Type(function(value){return value instanceof type})}(type)}else{throw new ERR.Type("Param type",["overload2.Type","string","Function"],type)}this.type=type;var DECOS=["NULL","UNDEFINED"];for(var i=1;i<arguments.length;i++){decos=decos.concat(arguments[i].trim().split(/\s+/))}for(var i=0;i<decos.length;i++){var rawDeco=decos[i];decos[i]=decos[i].toUpperCase();if(!has(DECOS,decos[i])){throw new ERR.Range("param decorator",DECOS,rawDeco)}}this.nil=has(decos,"null");this.undef=has(decos,"undefined")}Param.parse=generateCreator(Param);Param.prototype.satisfy=function(value){if(value===null&&this.nil)return true;if(value===undefined&&this.undef)return true;return this.type.match(value)};function ParamList(){var params=[];for(var i=0,args;i<arguments.length;i++){args=arguments[i]instanceof Array?arguments[i]:[arguments[i]];params[i]=Param.parse.apply(null,args)}this.length=params.length;this.item=function(i){return params[i]}}ParamList.parse=generateCreator(ParamList);ParamList.prototype.satisfy=function(args){if(args.length!=this.length){return false}var matched=true;for(var i=0;matched&&i<this.length;i++){matched=this.item(i).satisfy(args[i])}return matched};function Overload(){if(arguments.length==0){throw new ERR.Arguments("1+",0)}var args=Array.from(arguments);var method=args.pop();if(typeof method=="function"){this.method=method}else{throw new ERR.Generic("overloading implementation function missed")}if(typeof args[0]=="number"){if(args.length>1){throw new ERR.Arguments(2,args.length+1)}this.paramCount=args[0]}else if(args[0]instanceof ParamList){if(args.length>1){throw new ERR.Arguments(2,args.length+1)}this.params=args[0]}else{this.params=ParamList.parse.apply(null,args)}}Overload.parse=generateCreator(Overload);Overload.prototype.exec=function(scope,args){if(typeof this.paramCount=="number"&&args.length!=this.paramCount){return false}if(this.params&&!this.params.satisfy(args)){return false}return[this.method.apply(scope,args)]};function OverloadedFunction(){if(!(this instanceof OverloadedFunction))return new OverloadedFunction;this._defaultMethod=null;this._overloads=[]}OverloadedFunction.prototype.exec=function(){return this.apply(this,arguments)};OverloadedFunction.prototype.apply=function(scope,args){if(this._overloads.length==0){throw new ERR.NotImplemented}for(var i=0,ret;i<this._overloads.length;i++){ret=this._overloads[i].exec(scope,args);if(ret){return ret[0]}}if(this._defaultMethod){return this.defaultMethod.apply(scope,args)}throw new ERR.Unmatching("Unmatching arguments: "+args)};OverloadedFunction.prototype.call=function(scope){var args=Array.from(arguments);return this.apply(scope,args.slice(1))};OverloadedFunction.prototype.overload=function(){var overloadInstance;if(arguments[0]instanceof Overload){overloadInstance=arguments[0];if(arguments[1]){this._defaultMethod=overloadInstance.method}if(arguments.length>2){console.warn("redundant arguments found")}}else{overloadInstance=Overload.parse.apply(null,arguments)}this._overloads.push(overloadInstance);return this};OverloadedFunction.prototype.default=function(method){if(typeof method!="function"){throw new ERR.Generic("invalid default method")}if(arguments.length>1){console.warn("redundant arguments found")}this._defaultMethod=method};function Overloader(){var overloaded=new OverloadedFunction;var append=function(args){overloaded.overload.apply(overloaded,args)};var saveDEF=function(args,isDefault){var overloadInstance;if(args[0]instanceof Overload){overloadInstance=args[0]}else{overloadInstance=Overload.parse.apply(null,args)}overloaded.overload(overloadInstance);if(isDefault){overloaded.defaultMethod=overloadInstance.method}};if(arguments.length){append(arguments)}var fn=function(){return overloaded.apply(this,arguments)};fn.overload=function(){append(arguments);return fn};fn.default=function(method){overloaded.default(method);return fn};return fn}Overloader.ANY=new Type(function(value){return true});Overloader.BOOLEAN=new Type(function(value){return typeof value=="boolean"});Overloader.CHAR=new Type(function(value){return typeof value=="string"&&value.length==1});Overloader.DEFINED=new Type(function(value){return typeof value!="undefined"});Overloader.FUNCTION=new Type(function(value){return typeof value=="function"});Overloader.NUMBER=new Type(function(value){return typeof value=="number"});Overloader.SCALAR=new Type(function(value){return["boolean","number","string"].indexOf(typeof value)>=0});Overloader.STRING=new Type(function(value){return typeof value=="string"});Overloader.enum=function(){var args=[];for(var i=0;i<arguments.length;i++){args.push(arguments[i])}return new Type(function(value){return args.indexOf(value)>=0})};Overloader.Type=Type;Overloader.type=Type;Overloader.parseType=Type;Overloader.Param=Param;Overloader.param=Param.parse;Overloader.parseParam=Param.parse;Overloader.ParamList=ParamList;Overloader.paramList=ParamList.parse;Overloader.parseParamList=ParamList.parse;Overloader.Overload=Overload;Overloader.overload=Overload.parse;Overloader.parseOverload=Overload.parse;Overloader.Function=OverloadedFunction;Overloader.createFunction=OverloadedFunction;for(var name in ERR){if(ERR.hasOwnProperty(name)){var Err=ERR[name];Overloader[Err.name]=Err}}var TYPE_ALIAS={"*":Overloader.ANY,any:Overloader.ANY,"boolean":Overloader.BOOLEAN,"char":Overloader.CHAR,defined:Overloader.DEFINED,"function":Overloader.FUNCTION,number:Overloader.NUMBER,scalar:Overloader.SCALAR,string:Overloader.STRING};module.exports=Overloader;
//# sourceMappingURL=overload2.map